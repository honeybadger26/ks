(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[609],{8669:function(t,e,n){Promise.resolve().then(n.bind(n,7153))},7153:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return g}});var s=n(7437),i=n(3),o=n(5523),r=n(3061),a=n(7212),c=n(2276);class l{static getInstance(t,e){return l.instance||(l.instance=new l,l.instance.onConnectionChange=t,l.instance.onTimeout=e,l.instance.connect()),l.instance}static resetInstance(){l.instance&&(l.instance.disconnect(),l.instance=null)}connect(){if(!this.isConnecting&&(!this.ws||this.ws.readyState!==WebSocket.CONNECTING&&this.ws.readyState!==WebSocket.OPEN))try{this.isConnecting=!0,this.ws=new WebSocket("wss://b79yxxezc8.execute-api.ap-southeast-2.amazonaws.com/production/"),this.ws.onopen=()=>{var t;this.isConnecting=!1,this.reconnectAttempts=0,null===(t=this.onConnectionChange)||void 0===t||t.call(this,!0)},this.ws.onmessage=t=>{try{let e=JSON.parse(t.data);this.handleMessage(e)}catch(t){}},this.ws.onclose=()=>{var t;this.isConnecting=!1,null===(t=this.onConnectionChange)||void 0===t||t.call(this,!1),this.shouldReconnect&&this.attemptReconnect()},this.ws.onerror=t=>{var e;console.error("WebSocket error:",t),this.isConnecting=!1,null===(e=this.onConnectionChange)||void 0===e||e.call(this,!1)}}catch(t){console.error("Error creating WebSocket connection:",t),this.attemptReconnect()}}handleMessage(t){this.startTimeout(),(this.messageHandlers.get(t.type)||[]).forEach(e=>e(t))}startTimeout(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{var t;null===(t=this.onTimeout)||void 0===t||t.call(this),l.resetInstance()},1e4)}attemptReconnect(){this.reconnectAttempts<5&&(this.reconnectAttempts++,setTimeout(()=>{this.connect()},1e3*this.reconnectAttempts))}on(t,e){return this.messageHandlers.has(t)||this.messageHandlers.set(t,[]),this.messageHandlers.get(t).push(e),()=>{let n=this.messageHandlers.get(t);if(n){let t=n.indexOf(e);t>-1&&n.splice(t,1)}}}send(t){this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify(t))}solve(t,e,n){let s=(0,c.mI)(n);this.startTimeout(),this.send({type:"solve",puzzle:{board:{height:t,width:e},blocks:s}})}isConnected(){var t;return(null===(t=this.ws)||void 0===t?void 0:t.readyState)===WebSocket.OPEN}disconnect(){this.shouldReconnect=!1,this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.ws&&(this.ws.close(),this.ws=null),this.isConnecting=!1}constructor(){this.ws=null,this.messageHandlers=new Map,this.reconnectAttempts=0,this.isConnecting=!1,this.shouldReconnect=!0,this.timeout=null}}l.instance=null;var u=n(547),m=n(9376),h=n(2265);let d=t=>{if(t<1e3)return"".concat(t,"ms");let e=t/1e3;return e<60?"".concat(e.toFixed(2),"s"):"".concat(Math.floor(e/60),"m ").concat(Math.ceil(e%60),"s")};function g(){let t=(0,m.useRouter)(),[e,n]=(0,h.useState)(void 0),[g,p]=(0,h.useState)(""),[f,b]=(0,h.useState)(!1),v=(0,h.useRef)(null),[w,x]=(0,h.useState)(!1),[C,k]=(0,h.useState)(void 0);return(0,h.useEffect)(()=>{let t=l.getInstance(b,()=>p("Request timed out :("));return v.current=t,t.on("board_state",t=>{t.board&&k(t.board)}),t.on("solution",t=>{t.solution&&n({grid:t.solution,executionTimeMs:t.executionTimeMs||0}),l.resetInstance()}),t.on("no_solution",t=>{p(t.message||"No solution found"),l.resetInstance()}),t.on("error",t=>{p(t.message||"WebSocket error occurred"),l.resetInstance()}),()=>{v.current=null}},[]),(0,h.useEffect)(()=>{if(w||!f)return;let e=(0,u.k)(),n=(0,c.tX)();if(null===e||null===n){t.replace("/");return}x(!0),k(void 0);try{var s;null===(s=v.current)||void 0===s||s.solve(e.rows,e.cols,n)}catch(t){p(t.message)}},[t,f,w]),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-fit mx-auto",children:g?(0,s.jsx)(r.y,{children:g}):e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.$,{grid:e.grid}),(0,s.jsxs)("div",{className:"mt-4 text-sm",children:["Execution time: ",d(e.executionTimeMs)]})]}):f&&C?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.$,{grid:C}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(a.a,{text:"Finding solution"})})]}):(0,s.jsx)(a.a,{text:"Solving"})}),(0,s.jsx)(o.z,{extraClass:"mt-6",onClick:()=>{l.resetInstance(),t.push("/blocks")},children:"Back"})]})}},3:function(t,e,n){"use strict";n.d(e,{$:function(){return r}});var s=n(7437),i=n(8667);let o=["bg-white","bg-red-600","bg-blue-600","bg-green-500","bg-fuchsia-500","bg-amber-300","bg-teal-300","bg-violet-600","bg-amber-900","bg-slate-500"],r=t=>{let{grid:e,onClick:n}=t,r=()=>{let t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t.substr(0,4))},a=t=>0===t?"":o[(t-1)%o.length],c=(t,e,s)=>{if(n){var i;null==t||null===(i=t.dataTransfer)||void 0===i||i.setDragImage(new Image,0,0),n(e,s)}};return(0,s.jsxs)(s.Fragment,{children:[n&&(0,s.jsx)(i.default,{src:"https://bernardo-castilho.github.io/DragDropTouch/DragDropTouch.js"}),(0,s.jsx)("table",{children:(0,s.jsx)("tbody",{children:e.map((t,e)=>(0,s.jsx)("tr",{children:t.map((t,i)=>(0,s.jsx)("td",{draggable:!!n,className:"w-10 h-10 border-2 text-center ".concat(a(t)),onDragEnter:t=>c(t,e,i),onClick:r()?void 0:t=>c(t,e,i),onTouchStart:r()?t=>c(t,e,i):void 0},i))},e))})})]})}},5523:function(t,e,n){"use strict";n.d(e,{z:function(){return i}});var s=n(7437);let i=t=>{let{padding:e="px-6 py-3",extraClass:n="",children:i,onClick:o}=t;return(0,s.jsx)("button",{className:"bg-blue-500 active:bg-blue-600 text-slate-100 ".concat(e," ").concat(n),onClick:o,children:i})}},3061:function(t,e,n){"use strict";n.d(e,{y:function(){return i}});var s=n(7437);let i=t=>{let{children:e}=t;return(0,s.jsx)("div",{className:"text-rose-500",children:e})}},7212:function(t,e,n){"use strict";n.d(e,{a:function(){return i}});var s=n(7437);let i=t=>{let{text:e="Loading"}=t;return(0,s.jsxs)("div",{className:"flex justify-center",children:[(0,s.jsx)("svg",{className:"animate-spin mr-2",width:"24px",height:"24px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M12 21C10.5316 20.9987 9.08574 20.6382 7.78865 19.9498C6.49156 19.2614 5.38261 18.2661 4.55853 17.0507C3.73446 15.8353 3.22029 14.4368 3.06088 12.977C2.90147 11.5172 3.10167 10.0407 3.644 8.67604C4.18634 7.31142 5.05434 6.10024 6.17229 5.14813C7.29024 4.19603 8.62417 3.53194 10.0577 3.21378C11.4913 2.89563 12.9809 2.93307 14.3967 3.32286C15.8124 3.71264 17.1113 4.44292 18.18 5.45C18.3205 5.59062 18.3993 5.78125 18.3993 5.98C18.3993 6.17875 18.3205 6.36937 18.18 6.51C18.1111 6.58075 18.0286 6.63699 17.9376 6.67539C17.8466 6.71378 17.7488 6.73357 17.65 6.73357C17.5512 6.73357 17.4534 6.71378 17.3624 6.67539C17.2714 6.63699 17.189 6.58075 17.12 6.51C15.8591 5.33065 14.2303 4.62177 12.508 4.5027C10.7856 4.38362 9.07478 4.86163 7.66357 5.85624C6.25237 6.85085 5.22695 8.30132 4.75995 9.96345C4.29296 11.6256 4.41292 13.3979 5.09962 14.9819C5.78633 16.5659 6.99785 17.865 8.53021 18.6604C10.0626 19.4558 11.8222 19.6989 13.5128 19.3488C15.2034 18.9987 16.7218 18.0768 17.8123 16.7383C18.9028 15.3998 19.4988 13.7265 19.5 12C19.5 11.8011 19.579 11.6103 19.7197 11.4697C19.8603 11.329 20.0511 11.25 20.25 11.25C20.4489 11.25 20.6397 11.329 20.7803 11.4697C20.921 11.6103 21 11.8011 21 12C21 14.3869 20.0518 16.6761 18.364 18.364C16.6761 20.0518 14.387 21 12 21Z",fill:"#ffffff"})}),(0,s.jsx)("div",{className:"text-slate-400",children:e})]})}},2276:function(t,e,n){"use strict";n.d(e,{ND:function(){return r},mI:function(){return l},rG:function(){return o},tX:function(){return i}});var s=n(8685);let i=()=>{let t=localStorage.getItem(s.I);return t?JSON.parse(t):null},o=t=>{let e=JSON.stringify(t);e!==localStorage.getItem(s.I)&&localStorage.setItem(s.I,e)},r=t=>{o(Array.from(Array(t.numBlocks)).map(()=>Array.from(Array(t.rows)).map(()=>Array(t.cols).fill(0))))},a=t=>t.filter(t=>t.some(t=>0!==t)),c=t=>{let e=[];return t.forEach(t=>{t.forEach((t,n)=>{if(e.length===n)return e.push([t]);e[n].push(t)})}),e},l=t=>t.map(a).map(c).map(a)},8685:function(t,e,n){"use strict";n.d(e,{I:function(){return i},p:function(){return s}});let s="puzzle",i="blocks"},547:function(t,e,n){"use strict";n.d(e,{c:function(){return r},k:function(){return o}});var s=n(2276),i=n(8685);let o=()=>{let t=localStorage.getItem(i.p);return t?JSON.parse(t):null},r=t=>{let e=JSON.stringify(t);e!==localStorage.getItem(i.p)&&(localStorage.setItem(i.p,e),localStorage.removeItem(i.I),(0,s.ND)(t))}}},function(t){t.O(0,[782,971,117,744],function(){return t(t.s=8669)}),_N_E=t.O()}]);